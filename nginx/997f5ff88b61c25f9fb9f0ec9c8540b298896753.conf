# --
# envygeeks.io.conf:997f5ff88b61c25f9fb9f0ec9c8540b298896753
# Configuration for envygeeks.io
# --
server {
  ssl_certificate_key /var/ssl/997f5ff88b61c25f9fb9f0ec9c8540b298896753.key;
  ssl_trusted_certificate /var/ssl/997f5ff88b61c25f9fb9f0ec9c8540b298896753.crt;
  ssl_certificate /var/ssl/997f5ff88b61c25f9fb9f0ec9c8540b298896753.crt;
  set $key_non 'zkxIjxkAib12eto3YTntgZ0i+mysjFZ8BpiUWMZLoOE=';
  set $key_sha 'zkxIjxkAib12eto3YTntgZ0i+mysjFZ8BpiUWMZLoOE=';

  server_name envygeeks.io;
  root /srv/nginx/envygeeks.io;
  rewrite ^/(.*)/$ /$1 permanent;
  listen 443 ssl spdy;
  listen 80;

  location / {
    add_header access-control-allow-origin "*";
    add_header access-control-allow-methods "GET, OPTIONS";
    add_header strict-transport-security 'max-age=16590000; includeSubDomains; preload';
    add_header public-key-pins "pin-sha256=\"${key_sha}\"; pin-sha256=\"${key_non}\"; max-age=16590000; includeSubDomains; preload";
    add_header cache-control "private, max-age=0, proxy-revalidate, no-store, no-cache, must-revalidate";
    add_header x-content-type-options nosniff;
    add_header x-frame-options DENY;
    add_header pragma "private";
    etag off;

    try_files $uri.html $uri $uri/ =404;
  }

  # --
  # Make sure assets have a far-future cache.
  # --
  location ^~ /assets/ {
    access_log off;
    add_header Cache-Control "public";
    error_log  off;
    expires 1y;
  }
}
